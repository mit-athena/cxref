# makefile for cxref -- C cross referencing program
#
# Arnold Robbins, Information and Computer Science, Georgia Tech
#	gatech!arnold
# Copyright (c) 1985 by Arnold Robbins.
# All rights reserved.
# This program may not be sold, but may be distributed
# provided this header is included.

# some files are system dependant, e.g. where sort is.
# change the appropriate macro definitions and recompile.


### definitions of files to compile and load, and other targets for make

SCANOBJS= docxref.o cscan.o
SCANSRCS= docxref.c cscan.l

INCLS= constdefs.h basename.c
SRCS=  $(SCANSRCS) fmtxref.c cxrfilt.c cxref.c
DOCS=  README makefile cxref.1

PRINTS= $(INCLS) $(SRCS) $(DOCS)

### system dependant definitions, change when you install cxref

# for my use during development, put in my bin, but see next few lines.
CONFDIR=$(ATHBINDIR)
LIB= /usr/athena/lib/cxref

# may be /bin/sort on some systems
SORT=/usr/bin/sort

# printer program, prt is for me, use pr on other systems
P=pr

SimpleProgram(docxref,$(SCANOBJS),-ll,$(LIB))
SimpleProgram(fmtxref,fmtxref.c,,$(LIB))
SimpleProgram(cxrfilt,cxrfilt.c,,$(LIB))

cscan.o docxref.o cxrfilt.o: $(INCLS)

SimpleProgram(cxref,cxref.o,,$(ATHBINDIR))
SpecialObject(cxref.o,cxref.c,-DSRCDIR='"$(LIB)"' -DSORT='"$(SORT)"')

print:
	$(P) $(PRINTS) | lpr -b 'Cxref Source'
	touch print2

print2: $(PRINTS)
	$(P) $? | lpr -b 'Cxref New Source'
	touch print2

create_dir($(LIB))
install_man(cxref.1,cxref.1)

clean::
	$(RM) $(PROGS) print2


#if 0
depend:
	touch Make.depend; makedepend -fMake.depend ${CFLAGS} ${SRCS}
#endif

docxref.o: docxref.c basename.c
cscan.o: cscan.l constdefs.h
fmtxref.o: fmtxref.c basename.c
cxrfilt.o: cxrfilt.c constdefs.h basename.c
cxref.o: cxref.c 
cxref.o: basename.c

